{"ast":null,"code":"import _toConsumableArray from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,createRef}from\"react\";import axios from\"axios\";import{Accordion,Card}from\"react-bootstrap\";import{useAuth0}from\"@auth0/auth0-react\";import SetNewWorkout from\"./exercises/actions/create/SetNewWorkout\";import ViewWorkoutList from\"./exercises/ViewWorkoutList\";import NewLogList from\"./actions/create/NewLogList\";import RemoveLogList from\"./actions/remove/RemoveLogList\";import{isMobile}from\"react-device-detect\";import Swipe from\"react-easy-swipe\";import update from\"immutability-helper\";import EditLogList from\"./actions/edit/EditLogList\";import ToggleRemoval from\"../partials/ToggleRemoval\";import ToggleEdit from\"../partials/ToggleEdit\";import RemoveWorkout from\"./exercises/actions/remove/RemoveWorkout\";var ViewLogList=function ViewLogList(){var _useAuth=useAuth0(),user=_useAuth.user,isAuthenticated=_useAuth.isAuthenticated;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),isShown=_useState2[0],SetShown=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),isEdit=_useState4[0],SetEdit=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),isDisplayList=_useState6[0],SetDisplayList=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),isCurrID=_useState8[0],SetCurrID=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),isDeleteList=_useState10[0],SetDeleteList=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isDelete=_useState12[0],SetDelete=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isSwipedRight=_useState14[0],SetOnSwipeRight=_useState14[1];useEffect(function(){if(isAuthenticated){fetchData();}},[]);var fetchData=function fetchData(){var newLog=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var newWorkout=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(newWorkout===null){if(!newLog){axios.get(\"api/logs\").then(function(res){res.data.forEach(function(el,idx){if(el.username===user.email){var currList=[];var _loop=function _loop(attr){if(el.hasOwnProperty(attr)){if(attr===\"_id\")SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID),[el[attr]]);});currList.push({key:attr,val:el[attr]});}};for(var attr in el){_loop(attr);}SetShown(function(isShown){return[].concat(_toConsumableArray(isShown),[false]);});SetEdit(function(isEdit){return[].concat(_toConsumableArray(isEdit),[false]);});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList),[createRef()]);});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList),[currList]);});}});});}else{axios.get(\"api/logs/\").then(function(res){res.data.forEach(function(el,idx){if(el.username===user.email){if(!isCurrID.includes(el._id)){var currList=[];var _loop2=function _loop2(attr){if(el.hasOwnProperty(attr)){if(attr===\"_id\")SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID),[el[attr]]);});currList.push({key:attr,val:el[attr]});}};for(var attr in el){_loop2(attr);}SetShown(function(isShown){return[].concat(_toConsumableArray(isShown),[false]);});SetEdit(function(isEdit){return[].concat(_toConsumableArray(isEdit),[false]);});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList),[createRef()]);});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList),[currList]);});}}});});}}else{axios.get(\"api/logs/\".concat(newWorkout)).then(function(res){console.log(res.data);var newExerciseList=[];newExerciseList=res.data.exercises;var logLocation=isCurrID.indexOf(newWorkout);console.log(logLocation);if(!newLog){SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList.slice(0,logLocation)),[update(isDisplayList[logLocation],{0:{$set:{key:\"exercises\",val:newExerciseList}}})],_toConsumableArray(isDisplayList.slice(logLocation+1)));});}else{SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList.slice(0,logLocation)),[update(isDisplayList[logLocation],{$set:{0:{key:\"exercises\",val:res.data.exercises},2:{key:\"username\",val:res.data.username},3:{key:\"title\",val:res.data.title},4:{key:\"description\",val:res.data.description},5:{key:\"date\",val:new Date(res.data.date)}}})],_toConsumableArray(isDisplayList.slice(logLocation+1)));});}}).catch(function(err){console.log(err);});}};var onDelete=function onDelete(){// if(!isDelete){\n//\n// }\nSetDelete(!isDelete);};var onSwipeRight=function onSwipeRight(pos,event){if(isDelete){console.log(\"Moved to the right\",event);SetOnSwipeRight(true);}};var onSwipeEnd=function onSwipeEnd(event){if(isSwipedRight){handleDelete(Number(event.target.id.replace(/log-accordion-/g,\"\")));}};var handleDelete=function handleDelete(index){isDeleteList[index].current.classList.add(\"animate__animated\",\"animate__fadeOutRight\");isDeleteList[index].current.addEventListener(\"animationend\",function(){axios.delete(\"api/logs/\".concat(isCurrID[index])).then(function(res){console.log(res.data);}).catch(function(err){console.log(err);});SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID.slice(0,index)),[null],_toConsumableArray(isCurrID.slice(index+1)));});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList.slice(0,index)),[null],_toConsumableArray(isDisplayList.slice(index+1)));});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList.slice(0,index)),[null],_toConsumableArray(isDeleteList.slice(index+1)));});});SetOnSwipeRight(false);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,isDisplayList.map(function(el,index){if(el===null){return/*#__PURE__*/React.createElement(React.Fragment,null);}return/*#__PURE__*/React.createElement(Swipe,{onSwipeRight:onSwipeRight,onSwipeEnd:onSwipeEnd,allowMouseEvents:true,key:\"log-disp\"+index},/*#__PURE__*/React.createElement(Accordion,{className:\"p-2\",ref:isDeleteList[index]},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(RemoveLogList,{isDelete:isDelete,index:index,deleteData:handleDelete})),Object.entries(el).map(function(log){if(log[1].key===\"title\"){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Accordion.Toggle,{as:Card.Header,eventKey:\"0\",id:\"log-accordion-\"+\"\".concat(index),style:{transition:\"1s\",paddingLeft:!isDelete?\"1vw\":isMobile?\"13vw\":\"6vw\"}},isEdit[index]?/*#__PURE__*/React.createElement(\"div\",{className:\"ml-3 d-flex\"},/*#__PURE__*/React.createElement(\"h5\",null,\"Log Title: \"),/*#__PURE__*/React.createElement(\"input\",{id:\"log-title-\"+\"\".concat(index),className:\"ml-2\",size:10,placeholder:log[1].val})):/*#__PURE__*/React.createElement(\"div\",{className:isMobile?\"p-2\":\"ml-3 d-flex\"},/*#__PURE__*/React.createElement(\"h5\",{id:\"log-title-\"+\"\".concat(index)},log[1].val))));}else if(log[1].key===\"description\"){return/*#__PURE__*/React.createElement(Accordion.Collapse,{eventKey:!isDelete?\"0\":\"-1\"},/*#__PURE__*/React.createElement(Card.Body,null,/*#__PURE__*/React.createElement(\"div\",{className:\"p-2\"},isEdit[index]?/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"h5\",null,\"Log Description: \"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"textarea\",{id:\"log-desc-\".concat(index),cols:20,rows:2,placeholder:log[1].key===\"description\"&&log[1].val})):/*#__PURE__*/React.createElement(\"p\",{id:\"log-desc-\".concat(index)},log[1].key===\"description\"&&log[1].val),/*#__PURE__*/React.createElement(\"hr\",null)),/*#__PURE__*/React.createElement(React.Fragment,null,isEdit[index]?/*#__PURE__*/React.createElement(EditLogList,{el:el,index:index,isCurrID:isCurrID,isEdit:isEdit,SetEdit:SetEdit,updateData:fetchData}):/*#__PURE__*/React.createElement(ViewWorkoutList,{el:el,isCurrID:isCurrID,updateData:fetchData,logIndex:index,user:user})),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(SetNewWorkout,{index:index,isShown:isShown,SetShown:SetShown,isCurrID:isCurrID,updateData:fetchData,textColor:{color:\"black\"}}),/*#__PURE__*/React.createElement(ToggleEdit,{isEdit:isEdit,SetEdit:SetEdit,index:index,target:\"Log\",multiple:true})));}}))),/*#__PURE__*/React.createElement(Card,null,Object.entries(el).map(function(log){if(log[1].key===\"date\"){var date=new Date(log[1].val);return date.toDateString();}}))));})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-inline-start\"},/*#__PURE__*/React.createElement(NewLogList,{updateData:fetchData}),/*#__PURE__*/React.createElement(ToggleRemoval,{isDelete:isDelete,onDelete:onDelete,target:\"Log\"})));};export default ViewLogList;","map":{"version":3,"sources":["/var/www/Exercise_Logger/client/src/components/log/ViewLogList.js"],"names":["React","useState","useEffect","createRef","axios","Accordion","Card","useAuth0","SetNewWorkout","ViewWorkoutList","NewLogList","RemoveLogList","isMobile","Swipe","update","EditLogList","ToggleRemoval","ToggleEdit","RemoveWorkout","ViewLogList","user","isAuthenticated","isShown","SetShown","isEdit","SetEdit","isDisplayList","SetDisplayList","isCurrID","SetCurrID","isDeleteList","SetDeleteList","isDelete","SetDelete","isSwipedRight","SetOnSwipeRight","fetchData","newLog","newWorkout","get","then","res","data","forEach","el","idx","username","email","currList","attr","hasOwnProperty","push","key","val","includes","_id","console","log","newExerciseList","exercises","logLocation","indexOf","slice","$set","title","description","Date","date","catch","err","onDelete","onSwipeRight","pos","event","onSwipeEnd","handleDelete","Number","target","id","replace","index","current","classList","add","addEventListener","delete","map","Object","entries","Header","transition","paddingLeft","color","toDateString"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, createRef } from \"react\";\nimport axios from \"axios\";\nimport { Accordion, Card } from \"react-bootstrap\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport SetNewWorkout from \"./exercises/actions/create/SetNewWorkout\";\nimport ViewWorkoutList from \"./exercises/ViewWorkoutList\";\nimport NewLogList from \"./actions/create/NewLogList\";\nimport RemoveLogList from \"./actions/remove/RemoveLogList\";\nimport { isMobile } from \"react-device-detect\";\nimport Swipe from \"react-easy-swipe\";\nimport update from \"immutability-helper\";\nimport EditLogList from \"./actions/edit/EditLogList\";\nimport ToggleRemoval from \"../partials/ToggleRemoval\";\nimport ToggleEdit from \"../partials/ToggleEdit\";\nimport RemoveWorkout from \"./exercises/actions/remove/RemoveWorkout\";\n\nconst ViewLogList = () => {\n  const { user, isAuthenticated } = useAuth0();\n  const [isShown, SetShown] = useState([]);\n  const [isEdit, SetEdit] = useState([]);\n  const [isDisplayList, SetDisplayList] = useState([]);\n  const [isCurrID, SetCurrID] = useState([]);\n  const [isDeleteList, SetDeleteList] = useState([]);\n  const [isDelete, SetDelete] = useState(false);\n  const [isSwipedRight, SetOnSwipeRight] = useState(false);\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      fetchData();\n    }\n  }, []);\n\n  const fetchData = (newLog = false, newWorkout = null) => {\n    if (newWorkout === null) {\n      if (!newLog) {\n        axios.get(`api/logs`).then((res) => {\n          res.data.forEach((el, idx) => {\n            if (el.username === user.email) {\n              let currList = [];\n              for (let attr in el) {\n                if (el.hasOwnProperty(attr)) {\n                  if (attr === \"_id\")\n                    SetCurrID((isCurrID) => [...isCurrID, el[attr]]);\n                  currList.push({ key: attr, val: el[attr] });\n                }\n              }\n              SetShown((isShown) => [...isShown, false]);\n              SetEdit((isEdit) => [...isEdit, false]);\n              SetDeleteList((isDeleteList) => [...isDeleteList, createRef()]);\n              SetDisplayList((isDisplayList) => [...isDisplayList, currList]);\n            }\n          });\n        });\n      } else {\n        axios.get(`api/logs/`).then((res) => {\n          res.data.forEach((el, idx) => {\n            if (el.username === user.email) {\n              if (!isCurrID.includes(el._id)) {\n                let currList = [];\n                for (let attr in el) {\n                  if (el.hasOwnProperty(attr)) {\n                    if (attr === \"_id\")\n                      SetCurrID((isCurrID) => [...isCurrID, el[attr]]);\n                    currList.push({ key: attr, val: el[attr] });\n                  }\n                }\n                SetShown((isShown) => [...isShown, false]);\n                SetEdit((isEdit) => [...isEdit, false]);\n\n                SetDeleteList((isDeleteList) => [...isDeleteList, createRef()]);\n                SetDisplayList((isDisplayList) => [...isDisplayList, currList]);\n              }\n            }\n          });\n        });\n      }\n    } else {\n      axios\n        .get(`api/logs/${newWorkout}`)\n        .then((res) => {\n          console.log(res.data);\n          let newExerciseList = [];\n          newExerciseList = res.data.exercises;\n\n          let logLocation = isCurrID.indexOf(newWorkout);\n          console.log(logLocation);\n          if (!newLog) {\n            SetDisplayList((isDisplayList) => [\n              ...isDisplayList.slice(0, logLocation),\n              update(isDisplayList[logLocation], {\n                0: { $set: { key: \"exercises\", val: newExerciseList } },\n              }),\n              ...isDisplayList.slice(logLocation + 1),\n            ]);\n          } else {\n            SetDisplayList((isDisplayList) => [\n              ...isDisplayList.slice(0, logLocation),\n              update(isDisplayList[logLocation], {\n                $set: {\n                  0: { key: \"exercises\", val: res.data.exercises },\n                  2: { key: \"username\", val: res.data.username },\n                  3: { key: \"title\", val: res.data.title },\n                  4: { key: \"description\", val: res.data.description },\n                  5: { key: \"date\", val: new Date(res.data.date) },\n                },\n              }),\n              ...isDisplayList.slice(logLocation + 1),\n            ]);\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    }\n  };\n\n  const onDelete = () => {\n    // if(!isDelete){\n    //\n    // }\n    SetDelete(!isDelete);\n  };\n\n  const onSwipeRight = (pos, event) => {\n    if (isDelete) {\n      console.log(`Moved to the right`, event);\n      SetOnSwipeRight(true);\n    }\n  };\n  const onSwipeEnd = (event) => {\n    if (isSwipedRight) {\n      handleDelete(Number(event.target.id.replace(/log-accordion-/g, \"\")));\n    }\n  };\n\n  const handleDelete = (index) => {\n    isDeleteList[index].current.classList.add(\n      \"animate__animated\",\n      \"animate__fadeOutRight\"\n    );\n    isDeleteList[index].current.addEventListener(\"animationend\", () => {\n      axios\n        .delete(`api/logs/${isCurrID[index]}`)\n        .then((res) => {\n          console.log(res.data);\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n      SetCurrID((isCurrID) => [\n        ...isCurrID.slice(0, index),\n        null,\n        ...isCurrID.slice(index + 1),\n      ]);\n      SetDisplayList((isDisplayList) => [\n        ...isDisplayList.slice(0, index),\n        null,\n        ...isDisplayList.slice(index + 1),\n      ]);\n      SetDeleteList((isDeleteList) => [\n        ...isDeleteList.slice(0, index),\n        null,\n        ...isDeleteList.slice(index + 1),\n      ]);\n    });\n    SetOnSwipeRight(false);\n  };\n\n  return (\n    <>\n      <div>\n        {isDisplayList.map((el, index) => {\n          if (el === null) {\n            return <></>;\n          }\n          return (\n            <Swipe\n              onSwipeRight={onSwipeRight}\n              onSwipeEnd={onSwipeEnd}\n              allowMouseEvents={true}\n              key={\"log-disp\" + index}\n            >\n              <Accordion className={\"p-2\"} ref={isDeleteList[index]}>\n                <Card>\n                  {\n                    <>\n                      <>\n                        <RemoveLogList\n                          isDelete={isDelete}\n                          index={index}\n                          deleteData={handleDelete}\n                        />\n                      </>\n                      {Object.entries(el).map((log) => {\n                        if (log[1].key === \"title\") {\n                          return (\n                            <>\n                              <Accordion.Toggle\n                                as={Card.Header}\n                                eventKey=\"0\"\n                                id={\"log-accordion-\" + `${index}`}\n                                style={{\n                                  transition: \"1s\",\n                                  paddingLeft: !isDelete\n                                    ? \"1vw\"\n                                    : isMobile\n                                    ? \"13vw\"\n                                    : \"6vw\",\n                                }}\n                              >\n                                {isEdit[index] ? (\n                                  <div className={\"ml-3 d-flex\"}>\n                                    <h5>Log Title: </h5>\n                                    <input\n                                      id={\"log-title-\" + `${index}`}\n                                      className={\"ml-2\"}\n                                      size={10}\n                                      placeholder={log[1].val}\n                                    />\n                                  </div>\n                                ) : (\n                                  <div\n                                    className={isMobile ? \"p-2\" : \"ml-3 d-flex\"}\n                                  >\n                                    <h5 id={\"log-title-\" + `${index}`}>\n                                      {log[1].val}\n                                    </h5>\n                                  </div>\n                                )}\n                              </Accordion.Toggle>\n                            </>\n                          );\n                        } else if (log[1].key === \"description\") {\n                          return (\n                            <Accordion.Collapse\n                              eventKey={!isDelete ? \"0\" : \"-1\"}\n                            >\n                              <Card.Body>\n                                <div className={\"p-2\"}>\n                                  {isEdit[index] ? (\n                                    <div className={\"container\"}>\n                                      <h5>Log Description: </h5>\n                                      <hr />\n                                      <textarea\n                                        id={`log-desc-${index}`}\n                                        cols={20}\n                                        rows={2}\n                                        placeholder={\n                                          log[1].key === \"description\" &&\n                                          log[1].val\n                                        }\n                                      />\n                                    </div>\n                                  ) : (\n                                    <p id={`log-desc-${index}`}>\n                                      {log[1].key === \"description\" &&\n                                        log[1].val}\n                                    </p>\n                                  )}\n                                  <hr />\n                                </div>\n                                <>\n                                  {isEdit[index] ? (\n                                    <EditLogList\n                                      el={el}\n                                      index={index}\n                                      isCurrID={isCurrID}\n                                      isEdit={isEdit}\n                                      SetEdit={SetEdit}\n                                      updateData={fetchData}\n                                    />\n                                  ) : (\n                                    <ViewWorkoutList\n                                      el={el}\n                                      isCurrID={isCurrID}\n                                      updateData={fetchData}\n                                      logIndex={index}\n                                      user={user}\n                                    />\n                                  )}\n                                </>\n                                <hr />\n                                <SetNewWorkout\n                                  index={index}\n                                  isShown={isShown}\n                                  SetShown={SetShown}\n                                  isCurrID={isCurrID}\n                                  updateData={fetchData}\n                                  textColor={{ color: \"black\" }}\n                                />\n                                <ToggleEdit\n                                  isEdit={isEdit}\n                                  SetEdit={SetEdit}\n                                  index={index}\n                                  target={\"Log\"}\n                                  multiple={true}\n                                />\n                              </Card.Body>\n                            </Accordion.Collapse>\n                          );\n                        }\n                      })}\n                    </>\n                  }\n                </Card>\n\n                <Card>\n                  {Object.entries(el).map((log) => {\n                    if (log[1].key === \"date\") {\n                      let date = new Date(log[1].val);\n                      return date.toDateString();\n                    }\n                  })}\n                </Card>\n              </Accordion>\n            </Swipe>\n          );\n        })}\n      </div>\n      <div className={\"d-inline-start\"}>\n        <NewLogList updateData={fetchData} />\n        <ToggleRemoval isDelete={isDelete} onDelete={onDelete} target={\"Log\"} />\n      </div>\n    </>\n  );\n};\nexport default ViewLogList;\n"]},"metadata":{},"sourceType":"module"}