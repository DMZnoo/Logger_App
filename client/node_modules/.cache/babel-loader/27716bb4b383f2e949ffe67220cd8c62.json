{"ast":null,"code":"import _toConsumableArray from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,createRef}from\"react\";import axios from\"axios\";import{Accordion,Button,Card}from\"react-bootstrap\";import{useAuth0}from\"@auth0/auth0-react\";import SetNewWorkout from\"./SetNewWorkout\";import ViewWorkoutList from\"./ViewWorkoutList\";import SetNewLog from\"./SetNewLog\";import RemoveLog from\"./RemoveLog\";import RemoveLogList from\"./RemoveLogList\";import{BrowserView,MobileView}from\"react-device-detect\";import Swipe from\"react-easy-swipe\";var ViewLogList=function ViewLogList(){var _useAuth=useAuth0(),user=_useAuth.user,isAuthenticated=_useAuth.isAuthenticated;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),isShown=_useState2[0],SetShown=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),isDisplayList=_useState4[0],SetDisplayList=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),isCurrID=_useState6[0],SetCurrID=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),isDeleteList=_useState8[0],SetDeleteList=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isDelete=_useState10[0],SetDelete=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isSwipedRight=_useState12[0],SetOnSwipeRight=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isSwipeEnd=_useState14[0],SetSwipeOnEnd=_useState14[1];useEffect(function(){if(isAuthenticated){fetchData();}},[]);var fetchData=function fetchData(){var newLog=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!newLog){axios.get(\"api/logs\").then(function(res){res.data.forEach(function(el,idx){if(el.username===user.email){var currList=[];var _loop=function _loop(attr){if(el.hasOwnProperty(attr)){if(attr===\"_id\")SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID),[el[attr]]);});currList.push({key:attr,val:el[attr]});}};for(var attr in el){_loop(attr);}SetShown(function(isShown){return[].concat(_toConsumableArray(isShown),[false]);});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList),[createRef()]);});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList),[currList]);});}});});}else{axios.get(\"api/logs/\").then(function(res){res.data.forEach(function(el,idx){if(el.username===user.email){if(!isCurrID.includes(el._id)){var currList=[];var _loop2=function _loop2(attr){if(el.hasOwnProperty(attr)){if(attr===\"_id\")SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID),[el[attr]]);});currList.push({key:attr,val:el[attr]});}};for(var attr in el){_loop2(attr);}SetShown(function(isShown){return[].concat(_toConsumableArray(isShown),[false]);});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList),[createRef()]);});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList),[currList]);});}}});});}};var onDelete=function onDelete(){SetDelete(!isDelete);};var onSwipeRight=function onSwipeRight(pos,event){if(isDelete){console.log(\"Moved to the right\",event);SetOnSwipeRight(true);}};var onSwipeEnd=function onSwipeEnd(event){if(isSwipedRight){handleDelete(Number(event.target.id.replace(/log-title-/g,\"\")));}};var handleDelete=function handleDelete(index){isDeleteList[index].current.classList.add(\"animate__animated\",\"animate__fadeOutRight\");isDeleteList[index].current.addEventListener(\"animationend\",function(){axios.delete(\"api/logs/\".concat(isCurrID[index])).then(function(res){console.log(res.data);}).catch(function(err){console.log(err);});SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID.slice(0,index)),[null],_toConsumableArray(isCurrID.slice(index+1)));});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList.slice(0,index)),[null],_toConsumableArray(isDisplayList.slice(index+1)));});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList.slice(0,index)),[null],_toConsumableArray(isDeleteList.slice(index+1)));});});SetOnSwipeRight(false);SetSwipeOnEnd(false);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,isDisplayList.map(function(el,index){if(el===null){return/*#__PURE__*/React.createElement(React.Fragment,null);}return/*#__PURE__*/React.createElement(Swipe,{onSwipeRight:onSwipeRight,onSwipeEnd:onSwipeEnd,allowMouseEvents:true,key:\"log-disp\"+index},/*#__PURE__*/React.createElement(Accordion,{className:\"p-2\",ref:isDeleteList[index]},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(RemoveLogList,{isDeleteList:isDelete,index:index,deleteData:handleDelete})),Object.entries(el).map(function(log){if(log[1].key===\"title\"){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(BrowserView,null,/*#__PURE__*/React.createElement(Accordion.Toggle,{as:Card.Header,eventKey:\"0\",id:\"log-title-\"+\"\".concat(index),style:{transition:\"1s\",paddingLeft:!isDelete?\"1vw\":\"6vw\"}},log[1].val)),/*#__PURE__*/React.createElement(MobileView,null,/*#__PURE__*/React.createElement(Accordion.Toggle,{as:Card.Header,eventKey:\"0\",id:\"log-title-\"+\"\".concat(index),style:{transition:\"1s\",paddingLeft:!isDelete?\"1vw\":\"13vw\"}},log[1].val)));}else if(log[1].key===\"description\"){return/*#__PURE__*/React.createElement(Accordion.Collapse,{eventKey:\"0\"},/*#__PURE__*/React.createElement(Card.Body,null,/*#__PURE__*/React.createElement(\"div\",{className:\"p-2\"},/*#__PURE__*/React.createElement(\"p\",{id:\"log-desc-\"+\"\".concat(index)},log[1].key===\"description\"&&log[1].val)),/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ViewWorkoutList,{el:el})),/*#__PURE__*/React.createElement(SetNewWorkout,{index:index,isShown:isShown,SetShown:SetShown,isCurrID:isCurrID})));}}))),/*#__PURE__*/React.createElement(Card,null,Object.entries(el).map(function(log){if(log[1].key===\"date\"){var date=new Date(log[1].val);return date.toDateString();}}))));})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-inline-start\"},/*#__PURE__*/React.createElement(SetNewLog,{updateData:fetchData}),/*#__PURE__*/React.createElement(RemoveLog,{isDelete:isDelete,onDelete:onDelete})));};export default ViewLogList;","map":{"version":3,"sources":["/var/www/Exercise_Logger/client/src/components/log/ViewLogList.js"],"names":["React","useState","useEffect","createRef","axios","Accordion","Button","Card","useAuth0","SetNewWorkout","ViewWorkoutList","SetNewLog","RemoveLog","RemoveLogList","BrowserView","MobileView","Swipe","ViewLogList","user","isAuthenticated","isShown","SetShown","isDisplayList","SetDisplayList","isCurrID","SetCurrID","isDeleteList","SetDeleteList","isDelete","SetDelete","isSwipedRight","SetOnSwipeRight","isSwipeEnd","SetSwipeOnEnd","fetchData","newLog","get","then","res","data","forEach","el","idx","username","email","currList","attr","hasOwnProperty","push","key","val","includes","_id","onDelete","onSwipeRight","pos","event","console","log","onSwipeEnd","handleDelete","Number","target","id","replace","index","current","classList","add","addEventListener","delete","catch","err","slice","map","Object","entries","Header","transition","paddingLeft","date","Date","toDateString"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, createRef } from \"react\";\nimport axios from \"axios\";\nimport { Accordion, Button, Card } from \"react-bootstrap\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport SetNewWorkout from \"./SetNewWorkout\";\nimport ViewWorkoutList from \"./ViewWorkoutList\";\nimport SetNewLog from \"./SetNewLog\";\nimport RemoveLog from \"./RemoveLog\";\nimport RemoveLogList from \"./RemoveLogList\";\nimport { BrowserView, MobileView } from \"react-device-detect\";\nimport Swipe from \"react-easy-swipe\";\n\nconst ViewLogList = () => {\n  const { user, isAuthenticated } = useAuth0();\n  const [isShown, SetShown] = useState([]);\n  const [isDisplayList, SetDisplayList] = useState([]);\n  const [isCurrID, SetCurrID] = useState([]);\n  const [isDeleteList, SetDeleteList] = useState([]);\n  const [isDelete, SetDelete] = useState(false);\n  const [isSwipedRight, SetOnSwipeRight] = useState(false);\n  const [isSwipeEnd, SetSwipeOnEnd] = useState(false);\n  useEffect(() => {\n    if (isAuthenticated) {\n      fetchData();\n    }\n  }, []);\n\n  const fetchData = (newLog = false) => {\n    if (!newLog) {\n      axios.get(`api/logs`).then((res) => {\n        res.data.forEach((el, idx) => {\n          if (el.username === user.email) {\n            let currList = [];\n            for (let attr in el) {\n              if (el.hasOwnProperty(attr)) {\n                if (attr === \"_id\")\n                  SetCurrID((isCurrID) => [...isCurrID, el[attr]]);\n                currList.push({ key: attr, val: el[attr] });\n              }\n            }\n            SetShown((isShown) => [...isShown, false]);\n            SetDeleteList((isDeleteList) => [...isDeleteList, createRef()]);\n            SetDisplayList((isDisplayList) => [...isDisplayList, currList]);\n          }\n        });\n      });\n    } else {\n      axios.get(`api/logs/`).then((res) => {\n        res.data.forEach((el, idx) => {\n          if (el.username === user.email) {\n            if (!isCurrID.includes(el._id)) {\n              let currList = [];\n              for (let attr in el) {\n                if (el.hasOwnProperty(attr)) {\n                  if (attr === \"_id\")\n                    SetCurrID((isCurrID) => [...isCurrID, el[attr]]);\n                  currList.push({ key: attr, val: el[attr] });\n                }\n              }\n              SetShown((isShown) => [...isShown, false]);\n              SetDeleteList((isDeleteList) => [...isDeleteList, createRef()]);\n              SetDisplayList((isDisplayList) => [...isDisplayList, currList]);\n            }\n          }\n        });\n      });\n    }\n  };\n\n  const onDelete = () => {\n    SetDelete(!isDelete);\n  };\n\n  const onSwipeRight = (pos, event) => {\n    if (isDelete) {\n      console.log(`Moved to the right`, event);\n      SetOnSwipeRight(true);\n    }\n  };\n  const onSwipeEnd = (event) => {\n    if (isSwipedRight) {\n      handleDelete(Number(event.target.id.replace(/log-title-/g, \"\")));\n    }\n  };\n\n  const handleDelete = (index) => {\n    isDeleteList[index].current.classList.add(\n      \"animate__animated\",\n      \"animate__fadeOutRight\"\n    );\n    isDeleteList[index].current.addEventListener(\"animationend\", () => {\n      axios\n        .delete(`api/logs/${isCurrID[index]}`)\n        .then((res) => {\n          console.log(res.data);\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n      SetCurrID((isCurrID) => [\n        ...isCurrID.slice(0, index),\n        null,\n        ...isCurrID.slice(index + 1),\n      ]);\n      SetDisplayList((isDisplayList) => [\n        ...isDisplayList.slice(0, index),\n        null,\n        ...isDisplayList.slice(index + 1),\n      ]);\n      SetDeleteList((isDeleteList) => [\n        ...isDeleteList.slice(0, index),\n        null,\n        ...isDeleteList.slice(index + 1),\n      ]);\n    });\n    SetOnSwipeRight(false);\n    SetSwipeOnEnd(false);\n  };\n\n  return (\n    <>\n      <div>\n        {isDisplayList.map((el, index) => {\n          if (el === null) {\n            return <></>;\n          }\n          return (\n            <Swipe\n              onSwipeRight={onSwipeRight}\n              onSwipeEnd={onSwipeEnd}\n              allowMouseEvents={true}\n              key={\"log-disp\" + index}\n            >\n              <Accordion className={\"p-2\"} ref={isDeleteList[index]}>\n                <Card>\n                  {\n                    <>\n                      <>\n                        <RemoveLogList\n                          isDeleteList={isDelete}\n                          index={index}\n                          deleteData={handleDelete}\n                        />\n                      </>\n                      {Object.entries(el).map((log) => {\n                        if (log[1].key === \"title\") {\n                          return (\n                            <>\n                              <BrowserView>\n                                <Accordion.Toggle\n                                  as={Card.Header}\n                                  eventKey=\"0\"\n                                  id={\"log-title-\" + `${index}`}\n                                  style={{\n                                    transition: \"1s\",\n                                    paddingLeft: !isDelete ? \"1vw\" : \"6vw\",\n                                  }}\n                                >\n                                  {log[1].val}\n                                </Accordion.Toggle>\n                              </BrowserView>\n                              <MobileView>\n                                <Accordion.Toggle\n                                  as={Card.Header}\n                                  eventKey=\"0\"\n                                  id={\"log-title-\" + `${index}`}\n                                  style={{\n                                    transition: \"1s\",\n                                    paddingLeft: !isDelete ? \"1vw\" : \"13vw\",\n                                  }}\n                                >\n                                  {log[1].val}\n                                </Accordion.Toggle>\n                              </MobileView>\n                            </>\n                          );\n                        } else if (log[1].key === \"description\") {\n                          return (\n                            <Accordion.Collapse eventKey=\"0\">\n                              <Card.Body>\n                                <div className={\"p-2\"}>\n                                  <p id={\"log-desc-\" + `${index}`}>\n                                    {log[1].key === \"description\" && log[1].val}\n                                  </p>\n                                </div>\n                                <>\n                                  <ViewWorkoutList el={el} />\n                                </>\n                                <SetNewWorkout\n                                  index={index}\n                                  isShown={isShown}\n                                  SetShown={SetShown}\n                                  isCurrID={isCurrID}\n                                />\n                              </Card.Body>\n                            </Accordion.Collapse>\n                          );\n                        }\n                      })}\n                    </>\n                  }\n                </Card>\n\n                <Card>\n                  {Object.entries(el).map((log) => {\n                    if (log[1].key === \"date\") {\n                      let date = new Date(log[1].val);\n                      return date.toDateString();\n                    }\n                  })}\n                </Card>\n              </Accordion>\n            </Swipe>\n          );\n        })}\n      </div>\n      <div className={\"d-inline-start\"}>\n        <SetNewLog updateData={fetchData} />\n        <RemoveLog isDelete={isDelete} onDelete={onDelete} />\n      </div>\n    </>\n  );\n};\nexport default ViewLogList;\n"]},"metadata":{},"sourceType":"module"}