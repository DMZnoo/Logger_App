{"ast":null,"code":"import _toConsumableArray from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,createRef}from\"react\";import axios from\"axios\";import{Accordion,Card}from\"react-bootstrap\";import{useAuth0}from\"@auth0/auth0-react\";import SetNewWorkout from\"./exercises/actions/create/SetNewWorkout\";import ViewWorkoutList from\"./exercises/ViewWorkoutList\";import NewLogList from\"./actions/create/NewLogList\";import RemoveLogList from\"./actions/remove/RemoveLogList\";import{isMobile}from\"react-device-detect\";import Swipe from\"react-easy-swipe\";import update from\"immutability-helper\";import EditLogList from\"./actions/edit/EditLogList\";import ToggleRemoval from\"../partials/ToggleRemoval\";import ToggleEdit from\"../partials/ToggleEdit\";import{resolveToLocation}from\"react-router-dom/modules/utils/locationUtils\";var qs=require(\"querystring\");var ViewLogList=function ViewLogList(){var _useAuth=useAuth0(),user=_useAuth.user,isAuthenticated=_useAuth.isAuthenticated;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),isShown=_useState2[0],SetShown=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),isEdit=_useState4[0],SetEdit=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),isDisplayList=_useState6[0],SetDisplayList=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),isCurrID=_useState8[0],SetCurrID=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),isDeleteList=_useState10[0],SetDeleteList=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isDelete=_useState12[0],SetDelete=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isSwipedRight=_useState14[0],SetOnSwipeRight=_useState14[1];useEffect(function(){if(isAuthenticated){axios.post(\"api/users\",{username:user.email}).then(function(res){if(res.data!==0){fetchData(res.data);}}).catch(function(err){return console.log(err);});}},[]);var fetchData=function fetchData(){var log=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var update=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var newlog=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!update){Object.entries(log).forEach(function(id,index){var logDesc=[];Object.entries(id[1]).forEach(function(el,idx){if(el[0]===\"_id\")SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID),[el[1]]);});else if(el[0]!==\"__v\"){logDesc.push(el);}});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList),[logDesc]);});SetShown(function(isShown){return[].concat(_toConsumableArray(isShown),[false]);});SetEdit(function(isEdit){return[].concat(_toConsumableArray(isEdit),[false]);});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList),[createRef()]);});});}else{if(!newlog){var LogDesc=[];Object.entries(log).forEach(function(el,idx){LogDesc.push(el);});var index=isCurrID.indexOf(log._id);SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList.slice(0,index)),[LogDesc],_toConsumableArray(isDisplayList.slice(index+1)));});}else{var _LogDesc=[];Object.entries(log).forEach(function(el,idx){_LogDesc.push(el);});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList),[_LogDesc]);});SetShown(function(isShown){return[].concat(_toConsumableArray(isShown),[false]);});SetEdit(function(isEdit){return[].concat(_toConsumableArray(isEdit),[false]);});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList),[createRef()]);});}}};var onDelete=function onDelete(){SetDelete(!isDelete);};var onSwipeRight=function onSwipeRight(pos,event){if(isDelete){SetOnSwipeRight(true);}};var onSwipeEnd=function onSwipeEnd(event){if(isSwipedRight){handleDelete(Number(event.target.id.replace(/log-accordion-/g,\"\")));}};var handleDelete=function handleDelete(index){isDeleteList[index].current.classList.add(\"animate__animated\",\"animate__fadeOutRight\");isDeleteList[index].current.addEventListener(\"animationend\",function(){axios.delete(\"api/logs/\".concat(isCurrID[index])).then(function(res){SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID.slice(0,index)),_toConsumableArray(isCurrID.slice(index+1)));});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList.slice(0,index)),_toConsumableArray(isDisplayList.slice(index+1)));});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList.slice(0,index)),_toConsumableArray(isDeleteList.slice(index+1)));});}).catch(function(err){console.log(err);});});SetOnSwipeRight(false);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,isDisplayList.map(function(el,index){return/*#__PURE__*/React.createElement(Swipe,{onSwipeRight:onSwipeRight,onSwipeEnd:onSwipeEnd,allowMouseEvents:true,key:\"log-disp\"+index},/*#__PURE__*/React.createElement(Accordion,{className:\"p-2\",ref:isDeleteList[index]},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(RemoveLogList,{isDelete:isDelete,index:index,deleteData:handleDelete})),el.map(function(log){if(log[0]===\"title\"){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Accordion.Toggle,{as:Card.Header,eventKey:\"0\",id:\"log-accordion-\"+\"\".concat(index),style:{transition:\"1s\",paddingLeft:!isDelete?\"1vw\":isMobile?\"13vw\":\"6vw\"}},isEdit[index]?/*#__PURE__*/React.createElement(\"div\",{className:\"ml-2 form-group\"},/*#__PURE__*/React.createElement(\"label\",{for:\"log-title-\".concat(index),className:\"bmd-label-floating\"},\"New Title:\",\" \"),/*#__PURE__*/React.createElement(\"input\",{id:\"log-title-\".concat(index),className:\"ml-2 form-control\",size:10,placeholder:log[1]})):/*#__PURE__*/React.createElement(\"div\",{className:isMobile?\"p-2\":\"ml-3 d-flex\"},/*#__PURE__*/React.createElement(\"h5\",{id:\"log-title-\".concat(index)},log[1]))));}else if(log[0]===\"description\"){return/*#__PURE__*/React.createElement(Accordion.Collapse,{eventKey:!isDelete?\"0\":\"-1\"},/*#__PURE__*/React.createElement(Card.Body,null,/*#__PURE__*/React.createElement(\"div\",{className:\"p-2\"},isEdit[index]?/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{for:\"log-desc-\".concat(index),className:\"bmd-label-floating\"},\"Log Description:\",\" \"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"textarea\",{id:\"log-desc-\".concat(index),cols:20,className:\"form-control\",rows:2,placeholder:log[0]===\"description\"&&log[1]})):/*#__PURE__*/React.createElement(\"p\",{id:\"log-desc-\".concat(index)},log[0]===\"description\"&&log[1])),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(React.Fragment,null,isEdit[index]?/*#__PURE__*/React.createElement(EditLogList,{el:el,index:index,isCurrID:isCurrID,isEdit:isEdit,SetEdit:SetEdit,updateData:fetchData}):/*#__PURE__*/React.createElement(ViewWorkoutList,{el:el,isCurrID:isCurrID,updateData:fetchData,logIndex:index,user:user})),/*#__PURE__*/React.createElement(SetNewWorkout,{logIndex:index,isShown:isShown,SetShown:SetShown,isCurrID:isCurrID,updateData:fetchData,textColor:{color:\"black\"}}),/*#__PURE__*/React.createElement(ToggleEdit,{isEdit:isEdit,SetEdit:SetEdit,index:index,target:\"Log\",multiple:true})));}}))),/*#__PURE__*/React.createElement(Card,null,el.map(function(log){if(log[0]===\"date\"){var date=new Date(log[1]);return date.toDateString();}}))));})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-inline-start\"},/*#__PURE__*/React.createElement(NewLogList,{updateData:fetchData}),/*#__PURE__*/React.createElement(ToggleRemoval,{isDelete:isDelete,onDelete:onDelete,target:\"Log\"})));};export default ViewLogList;","map":{"version":3,"sources":["/var/www/Exercise_Logger/client/src/components/log/ViewLogList.js"],"names":["React","useState","useEffect","createRef","axios","Accordion","Card","useAuth0","SetNewWorkout","ViewWorkoutList","NewLogList","RemoveLogList","isMobile","Swipe","update","EditLogList","ToggleRemoval","ToggleEdit","resolveToLocation","qs","require","ViewLogList","user","isAuthenticated","isShown","SetShown","isEdit","SetEdit","isDisplayList","SetDisplayList","isCurrID","SetCurrID","isDeleteList","SetDeleteList","isDelete","SetDelete","isSwipedRight","SetOnSwipeRight","post","username","email","then","res","data","fetchData","catch","err","console","log","newlog","Object","entries","forEach","id","index","logDesc","el","idx","push","LogDesc","indexOf","_id","slice","onDelete","onSwipeRight","pos","event","onSwipeEnd","handleDelete","Number","target","replace","current","classList","add","addEventListener","delete","map","Header","transition","paddingLeft","color","date","Date","toDateString"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, createRef } from \"react\";\nimport axios from \"axios\";\nimport { Accordion, Card } from \"react-bootstrap\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport SetNewWorkout from \"./exercises/actions/create/SetNewWorkout\";\nimport ViewWorkoutList from \"./exercises/ViewWorkoutList\";\nimport NewLogList from \"./actions/create/NewLogList\";\nimport RemoveLogList from \"./actions/remove/RemoveLogList\";\nimport { isMobile } from \"react-device-detect\";\nimport Swipe from \"react-easy-swipe\";\nimport update from \"immutability-helper\";\nimport EditLogList from \"./actions/edit/EditLogList\";\nimport ToggleRemoval from \"../partials/ToggleRemoval\";\nimport ToggleEdit from \"../partials/ToggleEdit\";\nimport { resolveToLocation } from \"react-router-dom/modules/utils/locationUtils\";\nlet qs = require(\"querystring\");\nconst ViewLogList = () => {\n  const { user, isAuthenticated } = useAuth0();\n  const [isShown, SetShown] = useState([]);\n  const [isEdit, SetEdit] = useState([]);\n  const [isDisplayList, SetDisplayList] = useState([]);\n  const [isCurrID, SetCurrID] = useState([]);\n  const [isDeleteList, SetDeleteList] = useState([]);\n  const [isDelete, SetDelete] = useState(false);\n  const [isSwipedRight, SetOnSwipeRight] = useState(false);\n  useEffect(() => {\n    if (isAuthenticated) {\n      axios\n        .post(\"api/users\", { username: user.email })\n        .then((res) => {\n          if (res.data !== 0) {\n            fetchData(res.data);\n          }\n        })\n        .catch((err) => console.log(err));\n    }\n  }, []);\n\n  const fetchData = (log = null, update = false, newlog = false) => {\n    if (!update) {\n      Object.entries(log).forEach((id, index) => {\n        let logDesc = [];\n        Object.entries(id[1]).forEach((el, idx) => {\n          if (el[0] === \"_id\") SetCurrID((isCurrID) => [...isCurrID, el[1]]);\n          else if (el[0] !== \"__v\") {\n            logDesc.push(el);\n          }\n        });\n        SetDisplayList((isDisplayList) => [...isDisplayList, logDesc]);\n        SetShown((isShown) => [...isShown, false]);\n        SetEdit((isEdit) => [...isEdit, false]);\n        SetDeleteList((isDeleteList) => [...isDeleteList, createRef()]);\n      });\n    } else {\n      if (!newlog) {\n        let LogDesc = [];\n        Object.entries(log).forEach((el, idx) => {\n          LogDesc.push(el);\n        });\n        let index = isCurrID.indexOf(log._id);\n        SetDisplayList((isDisplayList) => [\n          ...isDisplayList.slice(0, index),\n          LogDesc,\n          ...isDisplayList.slice(index + 1),\n        ]);\n      } else {\n        let LogDesc = [];\n        Object.entries(log).forEach((el, idx) => {\n          LogDesc.push(el);\n        });\n        SetDisplayList((isDisplayList) => [...isDisplayList, LogDesc]);\n        SetShown((isShown) => [...isShown, false]);\n        SetEdit((isEdit) => [...isEdit, false]);\n        SetDeleteList((isDeleteList) => [...isDeleteList, createRef()]);\n      }\n    }\n  };\n\n  const onDelete = () => {\n    SetDelete(!isDelete);\n  };\n\n  const onSwipeRight = (pos, event) => {\n    if (isDelete) {\n      SetOnSwipeRight(true);\n    }\n  };\n  const onSwipeEnd = (event) => {\n    if (isSwipedRight) {\n      handleDelete(Number(event.target.id.replace(/log-accordion-/g, \"\")));\n    }\n  };\n\n  const handleDelete = (index) => {\n    isDeleteList[index].current.classList.add(\n      \"animate__animated\",\n      \"animate__fadeOutRight\"\n    );\n    isDeleteList[index].current.addEventListener(\"animationend\", () => {\n      axios\n        .delete(`api/logs/${isCurrID[index]}`)\n        .then((res) => {\n          SetCurrID((isCurrID) => [\n            ...isCurrID.slice(0, index),\n            ...isCurrID.slice(index + 1),\n          ]);\n          SetDisplayList((isDisplayList) => [\n            ...isDisplayList.slice(0, index),\n            ...isDisplayList.slice(index + 1),\n          ]);\n          SetDeleteList((isDeleteList) => [\n            ...isDeleteList.slice(0, index),\n            ...isDeleteList.slice(index + 1),\n          ]);\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    });\n    SetOnSwipeRight(false);\n  };\n\n  return (\n    <>\n      <div>\n        {isDisplayList.map((el, index) => {\n          return (\n            <Swipe\n              onSwipeRight={onSwipeRight}\n              onSwipeEnd={onSwipeEnd}\n              allowMouseEvents={true}\n              key={\"log-disp\" + index}\n            >\n              <Accordion className={\"p-2\"} ref={isDeleteList[index]}>\n                <Card>\n                  {\n                    <>\n                      <>\n                        <RemoveLogList\n                          isDelete={isDelete}\n                          index={index}\n                          deleteData={handleDelete}\n                        />\n                      </>\n                      {el.map((log) => {\n                        if (log[0] === \"title\") {\n                          return (\n                            <>\n                              <Accordion.Toggle\n                                as={Card.Header}\n                                eventKey=\"0\"\n                                id={\"log-accordion-\" + `${index}`}\n                                style={{\n                                  transition: \"1s\",\n                                  paddingLeft: !isDelete\n                                    ? \"1vw\"\n                                    : isMobile\n                                    ? \"13vw\"\n                                    : \"6vw\",\n                                }}\n                              >\n                                {isEdit[index] ? (\n                                  <div className={\"ml-2 form-group\"}>\n                                    <label\n                                      for={`log-title-${index}`}\n                                      className=\"bmd-label-floating\"\n                                    >\n                                      New Title:{\" \"}\n                                    </label>\n                                    <input\n                                      id={`log-title-${index}`}\n                                      className={\"ml-2 form-control\"}\n                                      size={10}\n                                      placeholder={log[1]}\n                                    />\n                                  </div>\n                                ) : (\n                                  <div\n                                    className={isMobile ? \"p-2\" : \"ml-3 d-flex\"}\n                                  >\n                                    <h5 id={`log-title-${index}`}>{log[1]}</h5>\n                                  </div>\n                                )}\n                              </Accordion.Toggle>\n                            </>\n                          );\n                        } else if (log[0] === \"description\") {\n                          return (\n                            <Accordion.Collapse\n                              eventKey={!isDelete ? \"0\" : \"-1\"}\n                            >\n                              <Card.Body>\n                                <div className={\"p-2\"}>\n                                  {isEdit[index] ? (\n                                    <div className={\"form-group\"}>\n                                      <label\n                                        for={`log-desc-${index}`}\n                                        className=\"bmd-label-floating\"\n                                      >\n                                        Log Description:{\" \"}\n                                      </label>\n                                      <hr />\n                                      <textarea\n                                        id={`log-desc-${index}`}\n                                        cols={20}\n                                        className={\"form-control\"}\n                                        rows={2}\n                                        placeholder={\n                                          log[0] === \"description\" && log[1]\n                                        }\n                                      />\n                                    </div>\n                                  ) : (\n                                    <p id={`log-desc-${index}`}>\n                                      {log[0] === \"description\" && log[1]}\n                                    </p>\n                                  )}\n                                </div>\n                                <hr />\n                                <>\n                                  {isEdit[index] ? (\n                                    <EditLogList\n                                      el={el}\n                                      index={index}\n                                      isCurrID={isCurrID}\n                                      isEdit={isEdit}\n                                      SetEdit={SetEdit}\n                                      updateData={fetchData}\n                                    />\n                                  ) : (\n                                    <ViewWorkoutList\n                                      el={el}\n                                      isCurrID={isCurrID}\n                                      updateData={fetchData}\n                                      logIndex={index}\n                                      user={user}\n                                    />\n                                  )}\n                                </>\n                                <SetNewWorkout\n                                  logIndex={index}\n                                  isShown={isShown}\n                                  SetShown={SetShown}\n                                  isCurrID={isCurrID}\n                                  updateData={fetchData}\n                                  textColor={{ color: \"black\" }}\n                                />\n                                <ToggleEdit\n                                  isEdit={isEdit}\n                                  SetEdit={SetEdit}\n                                  index={index}\n                                  target={\"Log\"}\n                                  multiple={true}\n                                />\n                              </Card.Body>\n                            </Accordion.Collapse>\n                          );\n                        }\n                      })}\n                    </>\n                  }\n                </Card>\n\n                <Card>\n                  {el.map((log) => {\n                    if (log[0] === \"date\") {\n                      let date = new Date(log[1]);\n                      return date.toDateString();\n                    }\n                  })}\n                </Card>\n              </Accordion>\n            </Swipe>\n          );\n        })}\n      </div>\n      <div className={\"d-inline-start\"}>\n        <NewLogList updateData={fetchData} />\n        <ToggleRemoval isDelete={isDelete} onDelete={onDelete} target={\"Log\"} />\n      </div>\n    </>\n  );\n};\nexport default ViewLogList;\n"]},"metadata":{},"sourceType":"module"}