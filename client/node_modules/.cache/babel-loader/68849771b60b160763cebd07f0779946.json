{"ast":null,"code":"import _regeneratorRuntime from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/var/www/Exercise_Logger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,createRef,useLayoutEffect}from\"react\";import axios from\"axios\";import ViewWorkoutList from\"./exercises/ViewWorkoutList\";import update from\"immutability-helper\";import{Accordion,Card}from\"react-bootstrap\";import{useAuth0}from\"@auth0/auth0-react\";import NewLogList from\"./actions/create/NewLogList\";import RemoveLogList from\"./actions/remove/RemoveLogList\";import{isMobile}from\"react-device-detect\";import Swipe from\"react-easy-swipe\";import ToggleRemoval from\"../partials/ToggleRemoval\";import ToggleEdit from\"../partials/ToggleEdit\";import SubmitUpdate from\"../partials/SubmitUpdate\";var ViewLogList=function ViewLogList(){var _useAuth=useAuth0(),user=_useAuth.user,isAuthenticated=_useAuth.isAuthenticated;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),isShown=_useState2[0],SetShown=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),isEdit=_useState4[0],SetEdit=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),isDisplayList=_useState6[0],SetDisplayList=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),isCurrID=_useState8[0],SetCurrID=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),isDeleteList=_useState10[0],SetDeleteList=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isDelete=_useState12[0],SetDelete=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isSwipedRight=_useState14[0],SetOnSwipeRight=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),isWorkoutList=_useState16[0],SetWorkoutList=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),isNewExercise=_useState18[0],SetNewExercise=_useState18[1];useEffect(function(){if(isAuthenticated){axios.post(\"/api/users/\",{username:user.email}).then(function(res){// console.log(res.data);\nif(res.data!==\"New User\"){fetchData(res.data);}}).catch(function(err){return console.log(err);});}},[]);var fetchData=function fetchData(){var log=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var isUpdate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var newlog=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;console.log(log);if(!isUpdate){Object.entries(log).forEach(function(id,index){var LogDesc=[];var logId=-1;Object.entries(id[1]).forEach(function(el,idx){if(el[0]===\"_id\"){logId=el[1];SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID),[el[1]]);});}if(el[0]!==\"__v\"){LogDesc.push(el);}});SetWorkoutList(function(isWorkoutList){return[].concat(_toConsumableArray(isWorkoutList),[[]]);});SetWorkoutList(function(isWorkoutList){return update(isWorkoutList,_defineProperty({},isWorkoutList.length-1,{$push:[logId]}));});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList),[LogDesc]);});SetShown(function(isShown){return[].concat(_toConsumableArray(isShown),[false]);});SetEdit(function(isEdit){return[].concat(_toConsumableArray(isEdit),[false]);});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList),[createRef()]);});});}else{if(!newlog){var LogDesc=[];var exerciseList=[];var logId=-1;Object.entries(log).forEach(function(el,idx){if(el[0]!==\"__v\"){LogDesc.push(el);if(el[0]===\"_id\"){logId=el[1];}if(el[0]===\"exercises\"){exerciseList=el[1];}}});var index=isCurrID.indexOf(logId);SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList.slice(0,index)),[LogDesc],_toConsumableArray(isDisplayList.slice(index+1)));});}else{var _LogDesc=[];var _logId=-1;Object.entries(log).forEach(function(el,idx){if(el[0]!==\"__v\"){if(el[0]===\"_id\"){_logId=el[1];SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID),[el[1]]);});}_LogDesc.push(el);}});SetWorkoutList(function(isWorkoutList){return[].concat(_toConsumableArray(isWorkoutList),[[]]);});SetWorkoutList(function(isWorkoutList){return update(isWorkoutList,_defineProperty({},isWorkoutList.length-1,{$push:[_logId]}));});console.log(\"New Log:\",_LogDesc);SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList),[_LogDesc]);});SetShown(function(isShown){return[].concat(_toConsumableArray(isShown),[false]);});SetEdit(function(isEdit){return[].concat(_toConsumableArray(isEdit),[false]);});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList),[createRef()]);});}}};var onDelete=function onDelete(){SetDelete(!isDelete);};var onSwipeRight=function onSwipeRight(pos,event){if(isDelete){SetOnSwipeRight(true);}};var onSwipeEnd=function onSwipeEnd(event){if(isSwipedRight){handleDelete(Number(event.target.id.replace(/log-accordion-/g,\"\")));}};var handleDelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(index){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isDeleteList[index].current.classList.add(\"animate__animated\",\"animate__fadeOutRight\");isDeleteList[index].current.style.setProperty(\"--animate-duration\",\"0.5s\");isDeleteList[index].current.addEventListener(\"animationend\",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:SetCurrID(function(isCurrID){return[].concat(_toConsumableArray(isCurrID.slice(0,index)),[null],_toConsumableArray(isCurrID.slice(index+1)));});SetDeleteList(function(isDeleteList){return[].concat(_toConsumableArray(isDeleteList.slice(0,index)),[null],_toConsumableArray(isDeleteList.slice(index+1)));});SetDisplayList(function(isDisplayList){return[].concat(_toConsumableArray(isDisplayList.slice(0,index)),[null],_toConsumableArray(isDisplayList.slice(index+1)));});SetOnSwipeRight(false);_context.next=6;return axios.post(\"/api/users/delete/\".concat(isCurrID[index]),{username:user.email});case 6:res=_context.sent;console.log(res);case 8:case\"end\":return _context.stop();}}},_callee);})));case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDelete(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,isDisplayList.map(function(el,index){if(el===null){return/*#__PURE__*/React.createElement(React.Fragment,null);}return/*#__PURE__*/React.createElement(Swipe,{onSwipeRight:onSwipeRight,onSwipeEnd:onSwipeEnd,allowMouseEvents:true,key:\"log-disp\"+index},/*#__PURE__*/React.createElement(Accordion,{className:\"p-2\",ref:isDeleteList[index]},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(RemoveLogList,{isDelete:isDelete,index:index,deleteData:handleDelete})),el.map(function(log){if(log[0]===\"title\"){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Accordion.Toggle,{as:Card.Header,eventKey:\"0\",id:\"log-accordion-\"+\"\".concat(index),style:{transition:\"1s\",height:isMobile?\"8vh\":\"10vh\",paddingLeft:!isDelete?\"1vw\":isMobile?\"13vw\":\"6vw\"}},isEdit[index]?/*#__PURE__*/React.createElement(\"div\",{className:\"ml-2 form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"log-title-\".concat(index),className:\"bmd-label-floating\"},\"New Title:\",\" \"),/*#__PURE__*/React.createElement(\"input\",{id:\"log-title-\".concat(index),className:\"ml-2 form-control\",size:10,placeholder:log[1]})):/*#__PURE__*/React.createElement(\"div\",{className:isMobile?\"p-2\":\"ml-3 d-flex\"},/*#__PURE__*/React.createElement(\"h5\",{id:\"log-title-\".concat(index)},log[1]))));}else if(log[0]===\"description\"){return/*#__PURE__*/React.createElement(Accordion.Collapse,{eventKey:!isDelete?\"0\":\"-1\"},/*#__PURE__*/React.createElement(Card.Body,null,/*#__PURE__*/React.createElement(\"div\",{className:\"p-2\"},isEdit[index]?/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"log-desc-\".concat(index),className:\"bmd-label-floating\"},\"Log Description:\",\" \"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"textarea\",{id:\"log-desc-\".concat(index),cols:20,className:\"form-control\",rows:2,placeholder:log[0]===\"description\"&&log[1]})):/*#__PURE__*/React.createElement(\"p\",{id:\"log-desc-\".concat(index)},log[0]===\"description\"&&log[1])),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ViewWorkoutList,{isShown:isShown,SetShown:SetShown,isWorkoutList:isWorkoutList,SetWorkoutList:SetWorkoutList,SetNewExercise:SetNewExercise,isNewExercise:isNewExercise,index:index,onLogEdit:isEdit,isCurrID:isCurrID,user:user,updateData:fetchData}),isEdit[index]&&/*#__PURE__*/React.createElement(SubmitUpdate,{index:index,isCurrID:isCurrID,isEdit:isEdit,SetEdit:SetEdit,isEditList:isWorkoutList,updateData:fetchData,target:\"Log\"})),/*#__PURE__*/React.createElement(ToggleEdit,{isEdit:isEdit,SetEdit:SetEdit,index:index,target:\"Log\",multiple:true})));}}))),/*#__PURE__*/React.createElement(Card,null,el.map(function(log){if(log[0]===\"date\"){var date=new Date(log[1]);return date.toDateString();}}))));})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-inline-start\"},/*#__PURE__*/React.createElement(NewLogList,{updateData:fetchData,user:user}),/*#__PURE__*/React.createElement(ToggleRemoval,{isDelete:isDelete,onDelete:onDelete,target:\"Log\"})));};export default ViewLogList;","map":{"version":3,"sources":["/var/www/Exercise_Logger/client/src/components/log/ViewLogList.js"],"names":["React","useState","useEffect","createRef","useLayoutEffect","axios","ViewWorkoutList","update","Accordion","Card","useAuth0","NewLogList","RemoveLogList","isMobile","Swipe","ToggleRemoval","ToggleEdit","SubmitUpdate","ViewLogList","user","isAuthenticated","isShown","SetShown","isEdit","SetEdit","isDisplayList","SetDisplayList","isCurrID","SetCurrID","isDeleteList","SetDeleteList","isDelete","SetDelete","isSwipedRight","SetOnSwipeRight","isWorkoutList","SetWorkoutList","isNewExercise","SetNewExercise","post","username","email","then","res","data","fetchData","catch","err","console","log","isUpdate","newlog","Object","entries","forEach","id","index","LogDesc","logId","el","idx","push","length","$push","exerciseList","indexOf","slice","onDelete","onSwipeRight","pos","event","onSwipeEnd","handleDelete","Number","target","replace","current","classList","add","style","setProperty","addEventListener","map","Header","transition","height","paddingLeft","date","Date","toDateString"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, createRef, useLayoutEffect } from \"react\";\nimport axios from \"axios\";\nimport ViewWorkoutList from \"./exercises/ViewWorkoutList\";\nimport update from \"immutability-helper\";\nimport { Accordion, Card } from \"react-bootstrap\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport NewLogList from \"./actions/create/NewLogList\";\nimport RemoveLogList from \"./actions/remove/RemoveLogList\";\nimport { isMobile } from \"react-device-detect\";\nimport Swipe from \"react-easy-swipe\";\nimport ToggleRemoval from \"../partials/ToggleRemoval\";\nimport ToggleEdit from \"../partials/ToggleEdit\";\nimport SubmitUpdate from \"../partials/SubmitUpdate\";\nconst ViewLogList = () => {\n  const { user, isAuthenticated } = useAuth0();\n\n  const [isShown, SetShown] = useState([]);\n  const [isEdit, SetEdit] = useState([]);\n  const [isDisplayList, SetDisplayList] = useState([]);\n  const [isCurrID, SetCurrID] = useState([]);\n  const [isDeleteList, SetDeleteList] = useState([]);\n  const [isDelete, SetDelete] = useState(false);\n  const [isSwipedRight, SetOnSwipeRight] = useState(false);\n  const [isWorkoutList, SetWorkoutList] = useState([]);\n  const [isNewExercise, SetNewExercise] = useState(null);\n  useEffect(() => {\n    if (isAuthenticated) {\n      axios\n        .post(\"/api/users/\", { username: user.email })\n        .then((res) => {\n          // console.log(res.data);\n          if (res.data !== \"New User\") {\n            fetchData(res.data);\n          }\n        })\n        .catch((err) => console.log(err));\n    }\n  }, []);\n\n  const fetchData = (log = null, isUpdate = false, newlog = false) => {\n    console.log(log);\n    if (!isUpdate) {\n      Object.entries(log).forEach((id, index) => {\n        let LogDesc = [];\n        let logId = -1;\n        Object.entries(id[1]).forEach((el, idx) => {\n          if (el[0] === \"_id\") {\n            logId = el[1];\n            SetCurrID((isCurrID) => [...isCurrID, el[1]]);\n          }\n          if (el[0] !== \"__v\") {\n            LogDesc.push(el);\n          }\n        });\n        SetWorkoutList((isWorkoutList) => [...isWorkoutList, []]);\n        SetWorkoutList((isWorkoutList) =>\n          update(isWorkoutList, {\n            [isWorkoutList.length - 1]: {\n              $push: [logId],\n            },\n          })\n        );\n        SetDisplayList((isDisplayList) => [...isDisplayList, LogDesc]);\n        SetShown((isShown) => [...isShown, false]);\n        SetEdit((isEdit) => [...isEdit, false]);\n        SetDeleteList((isDeleteList) => [...isDeleteList, createRef()]);\n      });\n    } else {\n      if (!newlog) {\n        let LogDesc = [];\n        let exerciseList = [];\n        let logId = -1;\n        Object.entries(log).forEach((el, idx) => {\n          if (el[0] !== \"__v\") {\n            LogDesc.push(el);\n            if (el[0] === \"_id\") {\n              logId = el[1];\n            }\n            if (el[0] === \"exercises\") {\n              exerciseList = el[1];\n            }\n          }\n        });\n\n        let index = isCurrID.indexOf(logId);\n\n        SetDisplayList((isDisplayList) => [\n          ...isDisplayList.slice(0, index),\n          LogDesc,\n          ...isDisplayList.slice(index + 1),\n        ]);\n      } else {\n        let LogDesc = [];\n        let logId = -1;\n        Object.entries(log).forEach((el, idx) => {\n          if (el[0] !== \"__v\") {\n            if (el[0] === \"_id\") {\n              logId = el[1];\n              SetCurrID((isCurrID) => [...isCurrID, el[1]]);\n            }\n            LogDesc.push(el);\n          }\n        });\n        SetWorkoutList((isWorkoutList) => [...isWorkoutList, []]);\n        SetWorkoutList((isWorkoutList) =>\n          update(isWorkoutList, {\n            [isWorkoutList.length - 1]: {\n              $push: [logId],\n            },\n          })\n        );\n        console.log(\"New Log:\", LogDesc);\n        SetDisplayList((isDisplayList) => [...isDisplayList, LogDesc]);\n        SetShown((isShown) => [...isShown, false]);\n        SetEdit((isEdit) => [...isEdit, false]);\n        SetDeleteList((isDeleteList) => [...isDeleteList, createRef()]);\n      }\n    }\n  };\n\n  const onDelete = () => {\n    SetDelete(!isDelete);\n  };\n\n  const onSwipeRight = (pos, event) => {\n    if (isDelete) {\n      SetOnSwipeRight(true);\n    }\n  };\n  const onSwipeEnd = (event) => {\n    if (isSwipedRight) {\n      handleDelete(Number(event.target.id.replace(/log-accordion-/g, \"\")));\n    }\n  };\n\n  const handleDelete = async (index) => {\n    isDeleteList[index].current.classList.add(\n      \"animate__animated\",\n      \"animate__fadeOutRight\"\n    );\n    isDeleteList[index].current.style.setProperty(\"--animate-duration\", \"0.5s\");\n\n    isDeleteList[index].current.addEventListener(\"animationend\", async () => {\n      SetCurrID((isCurrID) => [\n        ...isCurrID.slice(0, index),\n        null,\n        ...isCurrID.slice(index + 1),\n      ]);\n      SetDeleteList((isDeleteList) => [\n        ...isDeleteList.slice(0, index),\n        null,\n        ...isDeleteList.slice(index + 1),\n      ]);\n      SetDisplayList((isDisplayList) => [\n        ...isDisplayList.slice(0, index),\n        null,\n        ...isDisplayList.slice(index + 1),\n      ]);\n      SetOnSwipeRight(false);\n\n      let res = await axios.post(`/api/users/delete/${isCurrID[index]}`, {\n        username: user.email,\n      });\n      console.log(res);\n    });\n  };\n\n  return (\n    <>\n      <div>\n        {isDisplayList.map((el, index) => {\n          if (el === null) {\n            return <></>;\n          }\n          return (\n            <Swipe\n              onSwipeRight={onSwipeRight}\n              onSwipeEnd={onSwipeEnd}\n              allowMouseEvents={true}\n              key={\"log-disp\" + index}\n            >\n              <Accordion className={\"p-2\"} ref={isDeleteList[index]}>\n                <Card>\n                  {\n                    <>\n                      <>\n                        <RemoveLogList\n                          isDelete={isDelete}\n                          index={index}\n                          deleteData={handleDelete}\n                        />\n                      </>\n                      {el.map((log) => {\n                        if (log[0] === \"title\") {\n                          return (\n                            <>\n                              <Accordion.Toggle\n                                as={Card.Header}\n                                eventKey=\"0\"\n                                id={\"log-accordion-\" + `${index}`}\n                                style={{\n                                  transition: \"1s\",\n                                  height: isMobile ? \"8vh\" : \"10vh\",\n                                  paddingLeft: !isDelete\n                                    ? \"1vw\"\n                                    : isMobile\n                                    ? \"13vw\"\n                                    : \"6vw\",\n                                }}\n                              >\n                                {isEdit[index] ? (\n                                  <div className={\"ml-2 form-group\"}>\n                                    <label\n                                      htmlFor={`log-title-${index}`}\n                                      className=\"bmd-label-floating\"\n                                    >\n                                      New Title:{\" \"}\n                                    </label>\n                                    <input\n                                      id={`log-title-${index}`}\n                                      className={\"ml-2 form-control\"}\n                                      size={10}\n                                      placeholder={log[1]}\n                                    />\n                                  </div>\n                                ) : (\n                                  <div\n                                    className={isMobile ? \"p-2\" : \"ml-3 d-flex\"}\n                                  >\n                                    <h5 id={`log-title-${index}`}>{log[1]}</h5>\n                                  </div>\n                                )}\n                              </Accordion.Toggle>\n                            </>\n                          );\n                        } else if (log[0] === \"description\") {\n                          return (\n                            <Accordion.Collapse\n                              eventKey={!isDelete ? \"0\" : \"-1\"}\n                            >\n                              <Card.Body>\n                                <div className={\"p-2\"}>\n                                  {isEdit[index] ? (\n                                    <div className={\"form-group\"}>\n                                      <label\n                                        htmlFor={`log-desc-${index}`}\n                                        className=\"bmd-label-floating\"\n                                      >\n                                        Log Description:{\" \"}\n                                      </label>\n                                      <hr />\n                                      <textarea\n                                        id={`log-desc-${index}`}\n                                        cols={20}\n                                        className={\"form-control\"}\n                                        rows={2}\n                                        placeholder={\n                                          log[0] === \"description\" && log[1]\n                                        }\n                                      />\n                                    </div>\n                                  ) : (\n                                    <p id={`log-desc-${index}`}>\n                                      {log[0] === \"description\" && log[1]}\n                                    </p>\n                                  )}\n                                </div>\n                                <hr />\n                                <>\n                                  <ViewWorkoutList\n                                    isShown={isShown}\n                                    SetShown={SetShown}\n                                    isWorkoutList={isWorkoutList}\n                                    SetWorkoutList={SetWorkoutList}\n                                    SetNewExercise={SetNewExercise}\n                                    isNewExercise={isNewExercise}\n                                    index={index}\n                                    onLogEdit={isEdit}\n                                    isCurrID={isCurrID}\n                                    user={user}\n                                    updateData={fetchData}\n                                  />\n\n                                  {isEdit[index] && (\n                                    <SubmitUpdate\n                                      index={index}\n                                      isCurrID={isCurrID}\n                                      isEdit={isEdit}\n                                      SetEdit={SetEdit}\n                                      isEditList={isWorkoutList}\n                                      updateData={fetchData}\n                                      target={\"Log\"}\n                                    />\n                                  )}\n                                </>\n                                <ToggleEdit\n                                  isEdit={isEdit}\n                                  SetEdit={SetEdit}\n                                  index={index}\n                                  target={\"Log\"}\n                                  multiple={true}\n                                />\n                              </Card.Body>\n                            </Accordion.Collapse>\n                          );\n                        }\n                      })}\n                    </>\n                  }\n                </Card>\n\n                <Card>\n                  {el.map((log) => {\n                    if (log[0] === \"date\") {\n                      let date = new Date(log[1]);\n                      return date.toDateString();\n                    }\n                  })}\n                </Card>\n              </Accordion>\n            </Swipe>\n          );\n        })}\n      </div>\n      <div className={\"d-inline-start\"}>\n        <NewLogList updateData={fetchData} user={user} />\n        <ToggleRemoval isDelete={isDelete} onDelete={onDelete} target={\"Log\"} />\n      </div>\n    </>\n  );\n};\nexport default ViewLogList;\n"]},"metadata":{},"sourceType":"module"}